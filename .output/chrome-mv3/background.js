var background=(function(){"use strict";function z(r){return r==null||typeof r=="function"?{main:r}:r}const _=r=>Array.isArray(r)?r.map(s=>{if(!s||typeof s!="object")return null;const n=s;if(!n.id||!n.name||!Array.isArray(n.fields))return null;const C=n.fields.map($=>{if(!$||typeof $!="object")return null;const p=$;return!p.id||!p.name||!p.selector||!p.xpath||!p.mode||!p.source?null:{id:p.id,name:p.name,selector:p.selector,xpath:p.xpath,mode:p.mode,source:p.source,attrName:p.attrName,regex:typeof p.regex=="string"?p.regex:void 0,regexFlags:typeof p.regexFlags=="string"?p.regexFlags:void 0}}).filter($=>$!==null);return{id:n.id,name:n.name,fields:C,createdAt:n.createdAt??Date.now(),updatedAt:n.updatedAt??Date.now()}}).filter(s=>s!==null):[],H=r=>{var n;if(!r||typeof r!="object")return{name:"",fields:[],isPicking:!1};const s=r;return{name:typeof s.name=="string"?s.name:"",fields:((n=_([{id:"draft",name:"draft",fields:s.fields??[]}])[0])==null?void 0:n.fields)??[],isPicking:!!s.isPicking}},L="xcalibr_state",k={version:1,isOpen:!1,isWide:!1,isVisible:!0,searchQuery:"",tabOffsetY:0,showMenuBar:!1,isAnchored:!1,menuBarActiveMenu:null,menuBarActiveSubmenu:null,scrapers:[],scraperDraft:{name:"",fields:[],isPicking:!1},scraperBuilderOpen:!1,scraperRunnerOpen:!1,scraperRunnerId:null,scraperRunnerResults:null,scraperRunnerError:null,quickBarToolIds:[],toolWindows:{},toolData:{}},q=r=>{if(!r||typeof r!="object")return{...k};const s=r,n=typeof s.tabOffsetY=="number"?s.tabOffsetY:k.tabOffsetY,C=typeof s.isAnchored=="boolean"?s.isAnchored:k.isAnchored,$=typeof s.menuBarActiveMenu=="string"||s.menuBarActiveMenu===null?s.menuBarActiveMenu:k.menuBarActiveMenu,p=typeof s.menuBarActiveSubmenu=="string"||s.menuBarActiveSubmenu===null?s.menuBarActiveSubmenu:k.menuBarActiveSubmenu,j=_(s.scrapers),w=H(s.scraperDraft),e=typeof s.scraperBuilderOpen=="boolean"?s.scraperBuilderOpen:k.scraperBuilderOpen,t=typeof s.scraperRunnerOpen=="boolean"?s.scraperRunnerOpen:k.scraperRunnerOpen,i=typeof s.scraperRunnerId=="string"||s.scraperRunnerId===null?s.scraperRunnerId:k.scraperRunnerId,m=s.scraperRunnerResults&&typeof s.scraperRunnerResults=="object"?s.scraperRunnerResults:k.scraperRunnerResults,c=typeof s.scraperRunnerError=="string"||s.scraperRunnerError===null?s.scraperRunnerError:k.scraperRunnerError,a=Array.isArray(s.quickBarToolIds)?s.quickBarToolIds.filter(A=>typeof A=="string"):k.quickBarToolIds,u=s.toolWindows&&typeof s.toolWindows=="object"?s.toolWindows:k.toolWindows,d=s.toolData&&typeof s.toolData=="object"?s.toolData:k.toolData;return{...k,...s,tabOffsetY:n,isAnchored:C,menuBarActiveMenu:$,menuBarActiveSubmenu:p,scrapers:j,scraperDraft:w,scraperBuilderOpen:e,scraperRunnerOpen:t,scraperRunnerId:i,scraperRunnerResults:m,scraperRunnerError:c,quickBarToolIds:a,toolWindows:u,toolData:d,version:k.version}},G=async()=>{const r=await chrome.storage.local.get(L);return q(r[L])},V=async r=>{const s=await G(),n=typeof r=="function"?r(s):{...s,...r},C=q(n);return await chrome.storage.local.set({[L]:C}),C},Y=z(()=>{chrome.commands.onCommand.addListener(async r=>{r==="toggle-xcalibr-visibility"&&await V(s=>({...s,isVisible:!s.isVisible}))}),chrome.runtime.onMessage.addListener((r,s,n)=>{if((r==null?void 0:r.type)==="xcalibr-fetch-robots")return(async()=>{var u;const e=(u=s.tab)==null?void 0:u.id;if(typeof e!="number"){n({error:"No active tab available."});return}const i=(await chrome.tabs.get(e)).url;if(!i){n({error:"Unable to resolve tab URL."});return}const m=new URL(i).origin,a=await(await fetch(`${m}/robots.txt`,{redirect:"follow"})).text();n({url:`${m}/robots.txt`,content:a,updatedAt:Date.now()})})().catch(e=>{n({error:e instanceof Error?e.message:"Failed to fetch robots.txt."})}),!0;if((r==null?void 0:r.type)==="xcalibr-fetch-headers")return(async()=>{var a;const e=(a=s.tab)==null?void 0:a.id;if(typeof e!="number"){n({error:"No active tab available."});return}const i=(await chrome.tabs.get(e)).url;if(!i){n({error:"Unable to resolve tab URL."});return}const m=await fetch(i,{redirect:"follow"}),c=Array.from(m.headers.entries()).map(([u,d])=>({name:u,value:d}));n({url:i,status:m.status,headers:c,updatedAt:Date.now()})})().catch(e=>{n({error:e instanceof Error?e.message:"Failed to fetch headers."})}),!0;if((r==null?void 0:r.type)==="xcalibr-payload-replay")return(async()=>{const e=r.payload,t=await fetch(e.url,{method:e.method,headers:Object.fromEntries(e.headers.map(c=>[c.name,c.value])),body:e.method==="GET"||e.method==="HEAD"?void 0:e.body}),i=await t.text(),m=Array.from(t.headers.entries()).map(([c,a])=>({name:c,value:a}));n({responseStatus:t.status,responseHeaders:m,responseBody:i,error:void 0})})().catch(e=>{n({error:e instanceof Error?e.message:"Request failed."})}),!0;if((r==null?void 0:r.type)==="xcalibr-cors-check")return(async()=>{const{url:e}=r.payload,t=await fetch(e,{method:"GET"});n({result:{status:t.status,acao:t.headers.get("access-control-allow-origin"),acc:t.headers.get("access-control-allow-credentials"),methods:t.headers.get("access-control-allow-methods"),headers:t.headers.get("access-control-allow-headers")},updatedAt:Date.now()})})().catch(e=>{n({error:e instanceof Error?e.message:"CORS check failed."})}),!0;if((r==null?void 0:r.type)==="xcalibr-couchdb-fetch")return(async()=>{const{url:e}=r.payload,t=await fetch(e,{method:"GET"}),i=await t.text();n({output:i,error:t.ok?"":`Request failed (${t.status})`})})().catch(e=>{n({output:"",error:e instanceof Error?e.message:"Fetch failed."})}),!0;if((r==null?void 0:r.type)==="xcalibr-http-request")return(async()=>{const e=r.payload,t=await fetch(e.url,{method:e.method,headers:e.headers,body:e.method==="GET"||e.method==="HEAD"?void 0:e.body}),i=await t.text();n({status:t.status,statusText:t.statusText,headers:Array.from(t.headers.entries()).map(([m,c])=>({name:m,value:c})),body:i})})().catch(e=>{n({status:0,statusText:"",headers:[],body:"",error:e instanceof Error?e.message:"Request failed."})}),!0;if((r==null?void 0:r.type)==="xcalibr-whois-lookup")return(async()=>{const{domain:e}=r.payload;let t=e.toLowerCase().trim();t.includes("://")&&(t=new URL(t).hostname),t=t.replace(/^www\./,"");const i=t.split("."),m=i[i.length-1],c={com:"https://rdap.verisign.com/com/v1/domain/",net:"https://rdap.verisign.com/net/v1/domain/",org:"https://rdap.publicinterestregistry.org/rdap/domain/",io:"https://rdap.nic.io/domain/",co:"https://rdap.nic.co/domain/",dev:"https://rdap.nic.google/domain/",app:"https://rdap.nic.google/domain/",me:"https://rdap.nic.me/domain/",info:"https://rdap.afilias.net/rdap/info/domain/",biz:"https://rdap.nic.biz/domain/"},a=c[m]?`${c[m]}${t}`:`https://rdap.org/domain/${t}`,u=await fetch(a,{headers:{Accept:"application/rdap+json"}});if(!u.ok)throw new Error(`RDAP lookup failed: ${u.status} ${u.statusText}`);const d=await u.json(),A={domain:d.ldhName||t,status:Array.isArray(d.status)?d.status.join(", "):"Unknown",registrar:"",registrant:"",createdDate:"",expiresDate:"",updatedDate:"",nameservers:[]};if(Array.isArray(d.events)){for(const x of d.events)if(x.eventDate){const b=new Date(x.eventDate).toLocaleDateString();x.eventAction==="registration"?A.createdDate=b:x.eventAction==="expiration"?A.expiresDate=b:x.eventAction==="last changed"&&(A.updatedDate=b)}}if(Array.isArray(d.entities))for(const x of d.entities){const b=x.vcardArray;if(Array.isArray(b)&&b[1]){const D=b[1].find(B=>Array.isArray(B)&&B[0]==="fn"),E=D?D[3]:void 0;Array.isArray(x.roles)&&(x.roles.includes("registrar")&&E&&(A.registrar=E),x.roles.includes("registrant")&&E&&(A.registrant=E))}}Array.isArray(d.nameservers)&&(A.nameservers=d.nameservers.map(x=>x.ldhName).filter(Boolean)),n({result:A})})().catch(e=>{n({error:e instanceof Error?e.message:"WHOIS lookup failed."})}),!0;if((r==null?void 0:r.type)==="xcalibr-dns-lookup")return(async()=>{var a,u,d;const{domain:e}=r.payload;let t=e.toLowerCase().trim();t.includes("://")&&(t=new URL(t).hostname),t=t.replace(/^www\./,"");const i=["A","AAAA","MX","NS","TXT","CNAME","SOA"],m=[],c=await Promise.allSettled(i.map(async A=>{const x=`https://cloudflare-dns.com/dns-query?name=${encodeURIComponent(t)}&type=${A}`,b=await fetch(x,{headers:{Accept:"application/dns-json"}});return b.ok?b.json():null}));for(let A=0;A<c.length;A++){const x=c[A];if(x.status==="fulfilled"&&((a=x.value)!=null&&a.Answer))for(const b of x.value.Answer){const D={type:i[A],name:((u=b.name)==null?void 0:u.replace(/\.$/,""))||t,value:((d=b.data)==null?void 0:d.replace(/\.$/,""))||"",ttl:b.TTL};if(i[A]==="MX"&&typeof b.data=="string"){const E=b.data.split(" ");E.length>=2&&(D.priority=parseInt(E[0],10),D.value=E.slice(1).join(" ").replace(/\.$/,""))}m.push(D)}}if(m.length===0)throw new Error("No DNS records found");n({records:m})})().catch(e=>{n({error:e instanceof Error?e.message:"DNS lookup failed."})}),!0;if((r==null?void 0:r.type)==="xcalibr-reverse-ip-lookup")return(async()=>{const{ip:e}=r.payload,t=e.trim(),i=/^(\d{1,3}\.){3}\d{1,3}$/,m=/^([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$|^::([0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4}$|^([0-9a-fA-F]{1,4}:){1,7}:$|^([0-9a-fA-F]{1,4}:){0,6}::([0-9a-fA-F]{1,4}:){0,5}[0-9a-fA-F]{1,4}$/;if(!i.test(t)&&!m.test(t))throw new Error("Invalid IP address format");const c=`https://api.hackertarget.com/reverseiplookup/?q=${encodeURIComponent(t)}`,a=await fetch(c);if(!a.ok)throw new Error(`Reverse IP lookup failed: ${a.status}`);const u=await a.text();if(u.startsWith("error"))throw new Error(u);const d=u.split(`
`).map(A=>A.trim()).filter(A=>A&&!A.startsWith("error")&&A.includes("."));if(d.length===0)throw new Error("No domains found for this IP");n({domains:d})})().catch(e=>{n({error:e instanceof Error?e.message:"Reverse IP lookup failed."})}),!0;if((r==null?void 0:r.type)==="xcalibr-username-search")return(async()=>{const{username:e}=r.payload,t=[{name:"Twitter",url:`https://twitter.com/${e}`},{name:"GitHub",url:`https://github.com/${e}`},{name:"Reddit",url:`https://reddit.com/user/${e}`},{name:"Instagram",url:`https://instagram.com/${e}`},{name:"LinkedIn",url:`https://linkedin.com/in/${e}`}],i=[];for(const m of t)try{const c=await fetch(m.url,{method:"HEAD",redirect:"manual"});let a;c.status===200||c.status===301||c.status===302?a="found":c.status===404?a="not_found":c.status===403||c.status===429?a="error":a=c.status>=400?"not_found":"found",i.push({platform:m.name,url:m.url,status:a,statusCode:c.status,error:a==="error"?`HTTP ${c.status}`:void 0})}catch(c){i.push({platform:m.name,url:m.url,status:"error",statusCode:0,error:c instanceof Error?c.message:"Connection failed"})}n({results:i})})().catch(e=>{n({error:e instanceof Error?e.message:"Username search failed."})}),!0;if((r==null?void 0:r.type)==="xcalibr-email-breach-check")return(async()=>{const{email:e}=r.payload,t=`https://haveibeenpwned.com/api/v3/breachedaccount/${encodeURIComponent(e)}?truncateResponse=false`;try{const i=await fetch(t,{method:"GET",headers:{"User-Agent":"XCalibr-Extension","hibp-api-key":""}});if(i.status===404){n({breaches:[]});return}if(i.status===401)throw new Error("API key required. HIBP now requires a paid API key.");if(i.status===429)throw new Error("Rate limit exceeded. Please try again later.");if(!i.ok)throw new Error(`API error: ${i.status}`);const c=(await i.json()).map(a=>({name:a.Name,domain:a.Domain,breachDate:a.BreachDate,addedDate:a.AddedDate,pwnCount:a.PwnCount,description:a.Description.replace(/<[^>]*>/g,""),dataClasses:a.DataClasses,isVerified:a.IsVerified,isSensitive:a.IsSensitive}));n({breaches:c})}catch(i){if(i instanceof Error&&i.message.includes("API key"))n({error:"Email breach checking requires a Have I Been Pwned API key. Visit haveibeenpwned.com/API/Key to get one."});else throw i}})().catch(e=>{n({error:e instanceof Error?e.message:"Email breach check failed."})}),!0;if((r==null?void 0:r.type)==="xcalibr-ssl-cert-decode")return(async()=>{const{domain:e}=r.payload;let t=e.toLowerCase().trim();t.includes("://")&&(t=new URL(t).hostname),t=t.replace(/^www\./,"");const i=`https://crt.sh/?q=${encodeURIComponent(t)}&output=json`,m=await fetch(i,{headers:{Accept:"application/json"}});if(!m.ok)throw new Error(`Failed to fetch certificate: ${m.status}`);const c=await m.json();if(!c||c.length===0)throw new Error("No certificates found for this domain");const a=c[0],u={};a.issuer_name.split(",").forEach(E=>{const[B,o]=E.trim().split("=");B&&o&&(u[B.trim()]=o.trim())});const d=new Date(a.not_after),A=new Date,x=Math.floor((d.getTime()-A.getTime())/(1e3*60*60*24)),b=a.name_value.split(`
`).map(E=>E.trim()).filter(Boolean),D={subject:{CN:a.common_name,O:void 0,C:void 0},issuer:{CN:u.CN||u.O||"Unknown",O:u.O,C:u.C},validFrom:a.not_before,validTo:a.not_after,serialNumber:a.serial_number,fingerprint:`ID: ${a.id}`,signatureAlgorithm:"See crt.sh for details",keySize:void 0,sans:b,isExpired:x<0,daysUntilExpiry:x};n({certificate:D})})().catch(e=>{n({error:e instanceof Error?e.message:"SSL certificate decode failed."})}),!0;if((r==null?void 0:r.type)==="xcalibr-subdomain-find")return(async()=>{const{domain:e}=r.payload;let t=e.toLowerCase().trim();t.includes("://")&&(t=new URL(t).hostname),t=t.replace(/^www\./,"");const i=`https://crt.sh/?q=%25.${encodeURIComponent(t)}&output=json`,m=await fetch(i,{headers:{Accept:"application/json"}});if(!m.ok)throw new Error(`Failed to fetch subdomains: ${m.status}`);const c=await m.json();if(!c||c.length===0){n({subdomains:[]});return}const a=new Set;for(const d of c){if(d.common_name){const A=d.common_name.toLowerCase().trim();(A.endsWith(`.${t}`)||A===t)&&a.add(A)}if(d.name_value){const A=d.name_value.split(`
`);for(const x of A){const b=x.toLowerCase().trim();b&&!b.startsWith("*")&&(b.endsWith(`.${t}`)||b===t)&&a.add(b)}}}const u=Array.from(a).sort();n({subdomains:u})})().catch(e=>{n({error:e instanceof Error?e.message:"Subdomain search failed."})}),!0;if((r==null?void 0:r.type)==="xcalibr-wayback-search")return(async()=>{const{url:e}=r.payload;let t=e.trim();!t.startsWith("http://")&&!t.startsWith("https://")&&(t="https://"+t);const i=`https://web.archive.org/cdx/search/cdx?url=${encodeURIComponent(t)}&output=json&fl=timestamp,original,statuscode,mimetype&collapse=timestamp:6&limit=500`,m=await fetch(i,{headers:{Accept:"application/json"}});if(!m.ok)throw new Error(`Failed to fetch from Wayback Machine: ${m.status}`);const c=await m.json();if(!c||c.length<=1){n({snapshots:[]});return}const a=c.slice(1).map(u=>({timestamp:u[0],original:u[1],statuscode:u[2],mimetype:u[3]}));a.sort((u,d)=>d.timestamp.localeCompare(u.timestamp)),n({snapshots:a})})().catch(e=>{n({error:e instanceof Error?e.message:"Wayback Machine search failed."})}),!0;if((r==null?void 0:r.type)!=="xcalibr-inject-code")return;const{scope:C,code:$}=r.payload,p=async w=>{await chrome.scripting.insertCSS({target:{tabId:w},css:$})};return(async()=>{var e;if(C==="current"){const t=(e=s.tab)==null?void 0:e.id;typeof t=="number"&&await p(t),n({ok:!0});return}const w=await chrome.tabs.query({});await Promise.allSettled(w.map(t=>t.id).filter(t=>typeof t=="number").map(t=>p(t))),n({ok:!0})})().catch(()=>n({ok:!1})),!0})});function Q(){}var O={exports:{}},X=O.exports,W;function Z(){return W||(W=1,(function(r,s){(function(n,C){C(r)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:X,function(n){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)n.exports=globalThis.browser;else{const C="The message port closed before a response was received.",$=p=>{const j={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(j).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class w extends WeakMap{constructor(l,f=void 0){super(f),this.createItem=l}get(l){return this.has(l)||this.set(l,this.createItem(l)),super.get(l)}}const e=o=>o&&typeof o=="object"&&typeof o.then=="function",t=(o,l)=>(...f)=>{p.runtime.lastError?o.reject(new Error(p.runtime.lastError.message)):l.singleCallbackArg||f.length<=1&&l.singleCallbackArg!==!1?o.resolve(f[0]):o.resolve(f)},i=o=>o==1?"argument":"arguments",m=(o,l)=>function(h,...v){if(v.length<l.minArgs)throw new Error(`Expected at least ${l.minArgs} ${i(l.minArgs)} for ${o}(), got ${v.length}`);if(v.length>l.maxArgs)throw new Error(`Expected at most ${l.maxArgs} ${i(l.maxArgs)} for ${o}(), got ${v.length}`);return new Promise((T,S)=>{if(l.fallbackToNoCallback)try{h[o](...v,t({resolve:T,reject:S},l))}catch(g){console.warn(`${o} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,g),h[o](...v),l.fallbackToNoCallback=!1,l.noCallback=!0,T()}else l.noCallback?(h[o](...v),T()):h[o](...v,t({resolve:T,reject:S},l))})},c=(o,l,f)=>new Proxy(l,{apply(h,v,T){return f.call(v,o,...T)}});let a=Function.call.bind(Object.prototype.hasOwnProperty);const u=(o,l={},f={})=>{let h=Object.create(null),v={has(S,g){return g in o||g in h},get(S,g,P){if(g in h)return h[g];if(!(g in o))return;let y=o[g];if(typeof y=="function")if(typeof l[g]=="function")y=c(o,o[g],l[g]);else if(a(f,g)){let M=m(g,f[g]);y=c(o,o[g],M)}else y=y.bind(o);else if(typeof y=="object"&&y!==null&&(a(l,g)||a(f,g)))y=u(y,l[g],f[g]);else if(a(f,"*"))y=u(y,l[g],f["*"]);else return Object.defineProperty(h,g,{configurable:!0,enumerable:!0,get(){return o[g]},set(M){o[g]=M}}),y;return h[g]=y,y},set(S,g,P,y){return g in h?h[g]=P:o[g]=P,!0},defineProperty(S,g,P){return Reflect.defineProperty(h,g,P)},deleteProperty(S,g){return Reflect.deleteProperty(h,g)}},T=Object.create(o);return new Proxy(T,v)},d=o=>({addListener(l,f,...h){l.addListener(o.get(f),...h)},hasListener(l,f){return l.hasListener(o.get(f))},removeListener(l,f){l.removeListener(o.get(f))}}),A=new w(o=>typeof o!="function"?o:function(f){const h=u(f,{},{getContent:{minArgs:0,maxArgs:0}});o(h)}),x=new w(o=>typeof o!="function"?o:function(f,h,v){let T=!1,S,g=new Promise(N=>{S=function(I){T=!0,N(I)}}),P;try{P=o(f,h,S)}catch(N){P=Promise.reject(N)}const y=P!==!0&&e(P);if(P!==!0&&!y&&!T)return!1;const M=N=>{N.then(I=>{v(I)},I=>{let U;I&&(I instanceof Error||typeof I.message=="string")?U=I.message:U="An unexpected error occurred",v({__mozWebExtensionPolyfillReject__:!0,message:U})}).catch(I=>{console.error("Failed to send onMessage rejected reply",I)})};return M(y?P:g),!0}),b=({reject:o,resolve:l},f)=>{p.runtime.lastError?p.runtime.lastError.message===C?l():o(new Error(p.runtime.lastError.message)):f&&f.__mozWebExtensionPolyfillReject__?o(new Error(f.message)):l(f)},D=(o,l,f,...h)=>{if(h.length<l.minArgs)throw new Error(`Expected at least ${l.minArgs} ${i(l.minArgs)} for ${o}(), got ${h.length}`);if(h.length>l.maxArgs)throw new Error(`Expected at most ${l.maxArgs} ${i(l.maxArgs)} for ${o}(), got ${h.length}`);return new Promise((v,T)=>{const S=b.bind(null,{resolve:v,reject:T});h.push(S),f.sendMessage(...h)})},E={devtools:{network:{onRequestFinished:d(A)}},runtime:{onMessage:d(x),onMessageExternal:d(x),sendMessage:D.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:D.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},B={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return j.privacy={network:{"*":B},services:{"*":B},websites:{"*":B}},u(p,E,j)};n.exports=$(chrome)}})})(O)),O.exports}Z();function F(r,...s){}const K={debug:(...r)=>F(console.debug,...r),log:(...r)=>F(console.log,...r),warn:(...r)=>F(console.warn,...r),error:(...r)=>F(console.error,...r)};let R;try{R=Y.main(),R instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(r){throw K.error("The background crashed on startup!"),r}return R})();
background;
